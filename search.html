<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Search</title>

    <!-- =====================================================================
                                ********SCRIPTS********
         =====================================================================-->
    <!-- firebase.css -->
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.css" />
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Import materialize.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <!-- firebase -->
    <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
    <!-- Firebase Ui -->
    <script src="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.js"></script>
    <!-- jquery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- CSS Reference -->
    <link rel="stylesheet" type="text/css" href="assets\css\styleHome.css">
</head>

<body>

    <!-- =====================================================================
                                ********NAVBAR********
         =====================================================================-->
    <div class="card-panel grey darken-4 navBar">
        <nav class="card-panel grey darken-4 navBar">
            <div class="nav-wrapper">
                <a href="search.html" class="brand-logo" id="search" class="searchPage">
                    <i class="material-icons">pets</i>Where's Spot</a>
                <ul class="right hide-on-med-and-down">
                    <li>
                        <a href="search.html" id="search" class="searchPage">Search</a>
                    </li>
                    <li>
                        <a href="profile.html" id="profile" class="dogProfile">Profile</a>
                    </li>
                    <li>
                        <a href="index.html" id="about" class="aboutPage">About</a>
                    </li>
                    <li>
                        <a href="index.html" id="btnLogout" class="aboutPage">
                            <span class="light-green-text text-accent-3">Log Out</a>
                        </span>
                    </li>
                </ul>
            </div>
        </nav>
    </div>

    <!-- =====================================================================
                           ********GOOGLE MAPS********
         =====================================================================-->

    <div id="googleMaps"></div>

    <!-- =====================================================================
                        ********DROP DOWN MENU********
         =====================================================================-->
    <!-- Dropdown Menu Where Can Spot Go -->
    <div class="row">
        <div class="input-field col s6">
            <!-- Dropdown Trigger Where Can Spot Go -->
            <a class='dropdown-button btn card-panel grey darken-4' href='#' data-activates='dropdown1'>Where Can Spot Go</a>

            <!-- Dropdown Structure -->
            <ul id='dropdown1' class='dropdown-content'>
                <li>
                    <a href="#!" class="grey-text text-darken-4" data-val="Dog Park">Dog Park</a>
                </li>
                <li class="divider"></li>
                <li>
                    <a href="#!" class="grey-text text-darken-4" data-val="Pet Friendly Places">Pet Friendly Places</a>
                </li>
            </ul>
        </div>

        <!-- Dropdown Menu Where's Spot -->
        <div class="input-field col s6">
            <!-- Dropdown Where's Spot -->
            <a class='dropdown-button btn card-panel grey darken-4' href='#' data-activates='dropdown2'>Where's Spot</a>

            <!-- Dropdown Structure -->
            <ul id='dropdown2' class='dropdown-content'>
                <li>
                    <span class="grey-text text-darken-4">Orlando</span>
                </li>
                <li class="divider"></li>
                <li>
                    <span class="grey-text text-darken-4">Winter Garden</span>
                </li>
                <li class="divider"></li>
                <li>
                    <span class="grey-text text-darken-4">Winter Park</span>
                </li>
            </ul>
        </div>
    </div>
    <!-- =====================================================================
                            ********FOOTER******** 
         =====================================================================-->
    <footer class="page-footer card-panel grey lighten-3">
        <div class="container">
            <div class="row">
                <div class="col l6 s6">
                    <h5 class="white-text">
                        <span class="black-text">Add Group Member's Info</h5>
                    </span>
                </div>
            </div>
        </div>
        <div class="footer-copyright">
            <div class="container">
                <span class="black-text">Â© 2017 Copyright BEF</span>
            </div>
        </div>
    </footer>
    <!-- =====================================================================
                                ********SCRIPTS********
         =====================================================================-->
    <script>
// map variables
var map;
var infoWindow;
var service;

// storing the latitude and logitude of our class just in case we run into errors with browsers that no longer support non https browsers...Chrome 50
var latitude = 28.5383;
var longitude = -81.3792;

// geolocation function checkint to see if geolocation is supported on user's browser
function getLocation() {

	// if geolocation works
    if (navigator.geolocation) {

    	// pass the success or error function
        navigator.geolocation.getCurrentPosition(success, error);

    // if geolocation doesn't work
    } else { 

        console.log("Geolocation is not supported by this browser.");
    
    } // end if else

} // end getLocation()

// success function that was passed in getLocation above and is being passed the position we get from geolocation
function success(position) {

	// store the latitude coordinate in the latitude variable
	latitude = position.coords.latitude;
	console.log("Latitude: " + position.coords.latitude);

	// store the lognitude coordinates in the longitute variable
	longitude = position.coords.longitude;
    console.log("Longitude: " + position.coords.longitude);

} // end success()

// call the getLocatoin function so this works on page load
getLocation();

// map functions
function initMap() {

	// new google map
	map = new google.maps.Map(document.getElementById('googleMaps'), {

		// this is where to store the coordinates
		center: {lat: latitude, lng: longitude},
		// deals wtih the area the map displays
 		zoom: 13,

  	}); // end map

	
  	infoWindow = new google.maps.InfoWindow();
  	service = new google.maps.places.PlacesService(map);

  	// The idle event is a debounced event, so we can query & listen without
  	// throwing too many requests at the server.
  	map.addListener('idle', performSearch);

} // end initMap()

function performSearch() {

	// request object that takes the keywords for our search
  	var request = {
    	bounds: map.getBounds(),
    	keyword: 'Dog Parks Orlando'
  	};

  	// service is using the request and callback functions
  	service.radarSearch(request, callback);

} // end performSearch()

function callback(results, status) {

	// if there is no google map return an error
  	if (status !== google.maps.places.PlacesServiceStatus.OK) {
    	console.error(status);
    	return;
  	} // end if

  	// loop through the google map search results and display with markers to the map
  	for (var i = 0, result; result = results[i]; i++) {

    	// 	
	addMarker(result);
  	} // end for loop

} // end callback()

function addMarker(place) {

	// variable marker that plots the google places info
  	var marker = new google.maps.Marker({

    	map: map,
    	position: place.geometry.location,
    	icon:'assets/media/pets.png'

  	}); // end marker

	// google maps event listner that brings up the google maps info as a pop-up on the map when icon is clicked
  	google.maps.event.addListener(marker, 'click', function() {

    	service.getDetails(place, function(result, status) {

    		// check to make sure there is a google maps places and return errors if not
      		if (status !== google.maps.places.PlacesServiceStatus.OK) {
        		console.error(status);
        		return;
    		} // end if

    		// the details that are being passed to the pop-up on google maps
      		infoWindow.setContent(result.name);
      		infoWindow.open(map, marker);
    	}); // end service
  	
  	}); // end google maps marker event listner


}; // end addMarker()
    </script>
    <!-- materialize.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <!-- local javascript -->
    <script src="assets/javascript/app.js"></script>
    <!-- local javascript -->
    <script src="assets/javascript/database.js"></script>
    <!-- Google Maps -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHk95-lubVI3oVjkYiWihfYzcL3e5eX8g&callback=initMap&libraries=places"
        async defer></script>
        <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHk95-lubVI3oVjkYiWihfYzcL3e5eX8g&libraries=places"></script> -->
        
</body>

</html>